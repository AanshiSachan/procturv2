<loaders-css [loader]="'ball-scale-ripple-multiple'" class="app-loader-wrapper" [loaderClass]="'blueRipple'" *ngIf="isRippleLoad">
</loaders-css>
<div class="report-wrapper clearFix">
    <aside class="middle-full">
        <section class="middle-main clearFix">
            <div class="middle-top mb0 clearFix header">
                <div class="row report-header">
                    <h2 style="padding: 5px;" class="pull-left">
                        <a routerLink="/view/reports">
                            Report
                        </a>
                        <i style="font-family: 'FontAwesome';" class="fas fa-angle-right"></i>
                        <a routerLink="/view/reports/fee">
                            Fee Report
                        </a>
                        <div *ngIf=!isProfessional style="display:inline-block;">
                            <i style="font-family: 'FontAwesome';" class="fas fa-angle-right"></i> Course wise report
                        </div>
                        <div *ngIf=isProfessional style="display:inline-block;">
                            <i style="font-family: 'FontAwesome';" class="fas fa-angle-right"></i> Batch wise report
                        </div>
                    </h2>
                    <aside class="pull-left">
                        <rob-tooltip [textMessage]="'?'" [message]="helpMsg" [placement]="'left'" [customClass]="'left'">
                        </rob-tooltip>
                    </aside>
                </div>


                <!-- <div id="primary" *ngIf="!isFilterReversed">
                        <div class="c-lg-4">
                            <div class="form-wrapper">
                                <input [(ngModel)]='search_value' type="text" class="form-ctrl" placeholder="Search Name/Phone No.">
                            </div>
                        </div>
                        <div class="c-lg-2">
                            <div class="form-wrapper">
                                <select [(ngModel)]="due_type" name="" id="" class="form-ctrl">
                                    <option value="-1">Select Dues</option>
                                    <option value="all_dues">All Dues</option>
                                    <option value="next_month_dues">Next Month Dues</option>
                                    <option value="this_month_dues">This Month Dues</option>
                                    <option value="current_dues">Current Dues</option>
                                </select>
                            </div>
                        </div>
                        <div class="c-lg-1 filter-btn">
                            <button class="btn fullBlue" (click)="fetchFeeDetails()">Go</button>
                        </div>
                        <div style="margin-top: 10px" class="c-lg-2 filter-btn">
                            <a href="javascript:void(0);" id="adFilterOpen" (click)="openAdFilter()" class="openAdFilter">Switch Filter</a>
                        </div>
                        <div class="c-lg-3"></div>
                    </div> -->

                <div id="secondary" *ngIf="isFilterReversed">

                    <div class="c-lg-12" style="margin-left: -3%;">
                        <div class="c-lg-10">
                            <div class="c-lg-12">
                                <div class="c-lg-3">
                                    <div class="field-wrapper" [ngClass]="{'has-value': true }">
                                        <label for="mc">Master Course</label>
                                        <select *ngIf="isProfessional" [(ngModel)]="courseFetchForm.standard_id" (ngModelChange)="fetchSubjectList()" class="form-ctrl"
                                            name="mc" id="mc">
                                            <option value="-1"></option>
                                            <option *ngFor="let master of standardList" [value]="master.standard_id">{{master.standard_name}}</option>
                                        </select>
                                        <select *ngIf="!isProfessional" [(ngModel)]="courseFetchForm.standard_id" (ngModelChange)="fetchSubjectList()" class="form-ctrl"
                                            name="mc" id="mc">
                                            <option value="-1"></option>
                                            <option *ngFor="let master of standardList" [value]="master.master_course">{{master.master_course}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="c-lg-3">
                                    <div class="field-wrapper">
                                        <label for="cc">Course</label>
                                        <select *ngIf="isProfessional" [(ngModel)]="courseFetchForm.subject_id" (ngModelChange)="fetchBatchList()" class="form-ctrl"
                                            name="cc" id="cc">
                                            <option value="-1"></option>
                                            <option *ngFor="let course of subjectList" [value]="course.subject_id">{{course.subject_name}}</option>
                                        </select>
                                        <select *ngIf="!isProfessional" [(ngModel)]="courseFetchForm.subject_id" class="form-ctrl" name="cc" id="cc">
                                            <option value="-1"></option>
                                            <option *ngFor="let course of subjectList" [value]="course.course_id">{{course.course_name}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="c-lg-3" *ngIf="isProfessional">
                                    <div class="field-wrapper">
                                        <label for="ba">Batch</label>
                                        <select [(ngModel)]="courseFetchForm.batch_id" class="form-ctrl" (ngModelChange)="batchSelected()" name="" id="ba">
                                            <option value="-1"></option>
                                            <option *ngFor="let batch of batchList" [value]="batch.batch_id">{{batch.batch_name}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="c-lg-1 filter-btn" *ngIf="!isProfessional" style="margin-top: 25px;">
                                    <button class="btn fullBlue" (click)="fetchFeeDetails()">Go</button>
                                </div>
                                <div class="c-lg-1 filter-btn" *ngIf="isProfessional" style="margin-top: 25px;">
                                    <button class="btn fullBlue" (click)="fetchFeeDetails()">Go</button>
                                </div>
                                <!-- <div class="c-lg-3 sky-form field-wrapper  hide">
                                    <label>Academic Year</label>
                                    <select name="academic_year_array" id="academic_year_array" style="height:auto" [(ngModel)]="courseFetchForm.academic_year_id"
                                        class="form-ctrl sky-inner">
                                        <option value="-1">
                                        </option>
                                        <option *ngFor="let i of getAllAcademic" [value]="i.inst_acad_year_id">
                                            {{i.inst_acad_year}}
                                        </option>
                                    </select>
                                </div> -->

                            </div>
                        </div>
                    </div>
                </div>

                <div class="c-lg-3">
                    <div class="field-wrapper hide">
                        <label for="ic">Installment</label>
                        <select class="form-ctrl" name="" id="ic">
                            <option value="-1"></option>
                            <option [value]="i" *ngFor="let i of installmentList">{{i}}</option>
                        </select>
                    </div>
                </div>

                <!-- <div class="c-lg-3">
                            <div class="form-wrapper">
                                <label for="sd">Select Dues</label>
                                <select [(ngModel)]="due_type" (ngModelChange)="dateRangeChanges($event)" name="sd" id="sd" class="form-ctrl">
                                    <option value="-1"></option>
                                    <option value="all_dues">All Dues</option>
                                    <option value="next_month_dues">Next Month Dues</option>
                                    <option value="this_month_dues">This Month Dues</option>
                                    <option value="current_dues">Current Dues</option>
                                    <option value="custom">Custom</option>
                                </select>
                            </div>
                        </div> -->



                <div class="c-lg-3" *ngIf="isCustomDate">
                    <div class="field-wrapper datePickerBox">
                        <label for="ic">From Date</label>
                        <input [(ngModel)]="courseFetchForm.from_date" (ngModelChange)="validateFutureDate('from')" type="text" value="" readonly="true"
                            class="form-ctrl bsDatepicker" bsDatepicker/>
                    </div>
                    <span style="cursor: pointer; color: #ff0000;" (click)="courseFetchForm.from_date = ''">clear</span>
                </div>

                <div class="c-lg-3" *ngIf="isCustomDate">
                    <div class="field-wrapper datePickerBox">
                        <label for="ic">To Date</label>
                        <input [(ngModel)]="courseFetchForm.to_date" (ngModelChange)="validateFutureDate('to')" type="text" value="" readonly="true"
                            class="form-ctrl bsDatepicker" bsDatepicker/>
                    </div>
                    <span style="cursor: pointer;color: #ff0000;" (click)="courseFetchForm.to_date = ''">clear</span>
                </div>


                <div class="c-lg-1 filter-btn hide">
                    <div class="filter-right pull-right">
                        <a href="javascript:void(0);" id="adFilterOpen" (click)="openAdFilter()" class="openAdFilter">Switch Filter</a>
                    </div>
                </div>

            </div>


            <section>
                <div class="c-lg-8" style="padding: 15px 5px 0px 5px;">
                    <p-splitButton label="{{selectedRecordsList.length}} Record Selected" [model]="bulkAddItems" *ngIf="selectedRecordsList.length"></p-splitButton>
                </div>
                <div id="basic-search" style="margin:5px;">
                    <form autocomplete="off" #form="ngForm">
                        <input type="text" name="searchValue" [(ngModel)]="userInput" placeholder="Search" class="form-ctrl" id="searchBar" style="padding:7px 10px; width:200px; height:35px; float:right;">
                    </form>
                </div>
            </section>

            <section class="fee-table">
                <div class="table-content" *ngIf="isFilterReversed">
                    <div style="margin: 10px; display: inline-block;">
                        <a (click)="exportToExcel()" class="download" style="margin-top: 10px;">Download To Excel</a>
                        <span class="fa fa-cloud-download">
                        </span>
                    </div>
                    <ul *ngIf="feeDataSource1[0] != null || feeDataSource1[0] != undefined" style="display: inline-block;  text-align: left; width:37%;">
                        <li style=" margin-left: 11px; display: inline-block;">
                            <span class="made-out"> Total fees Collection </span>
                            <span class="made-in"> : ₹{{feeDataSource1[0].total_fees_collected.toLocaleString('en-IN')}}</span>
                        </li>
                        <li style="display: inline-block; margin-left: 10%;">
                            <span class="made-out">Total dues</span>
                            <span class="made-in"> : ₹{{feeDataSource1[0].total_dues_pending.toLocaleString('en-IN')}}</span>
                        </li>
                    </ul>
                    <ul *ngIf="feeDataSource1[0] != null || feeDataSource1[0] != undefined" style="display: inline-block;  text-align: left;width:37%;">
                        <li style=" margin-left: 11px; display: inline-block;">
                            <span class="made-out"> Total Future Dues </span>
                            <span class="made-in"> : ₹{{feeDataSource1[0].total_future_dues.toLocaleString('en-IN')}}</span>
                        </li>
                        <li style="display: inline-block; margin-left: 10%;">
                            <span class="made-out">Total Fees</span>
                            <span class="made-in"> : ₹{{feeDataSource1[0].total_fees.toLocaleString('en-IN')}}</span>
                        </li>
                    </ul>
                    <rob-table (rowIdArr)="selectedRecords($event)" [menuOptions]="menuOptions" (multiOptionSelected)="optionSelected($event)"
                        [isMulti]='true' [hasMenu]="true" [records]="feeDataSource1" [dataStatus]="dataStatus" [tableName]="'feereport'"
                        [settings]="feeSettings1">
                    </rob-table>
                </div>
                <div class="table-content" *ngIf="!isFilterReversed">
                    <rob-table [menuOptions]="menuOptions" [isMulti]='true' [hasMenu]="false" [records]="feeDataSource2" [tableName]="'feereport'"
                        [dataStatus]="dataStatus" [settings]="feeSettings2">
                    </rob-table>
                </div>
            </section>
        </section>
    </aside>

    <fee-receipt [feeData]="selectedFeeRecord" (closeButton)="closePopup($event)" *ngIf="isFeeReceipt"></fee-receipt>

    <next-due-detail [feeData]="selectedFeeRecord" (closeButton)="closePopup($event)" *ngIf="isNextDueDetail"></next-due-detail>

    <payment-history [feeData]="selectedFeeRecord" (closeButton)="closePopup($event)" *ngIf="isFeepaymentHistory"></payment-history>

    <view-detail-report [feeData]="selectedFeeRecord" (closeButton)="closePopup($event)" *ngIf="isViewDetailReport"></view-detail-report>

</div>