<section class="middle-section clearFix" [ngBusy]="{busy: busy, message: 'Loading...', delay: 100, maxDuration: 1000}" (click)="inputClicked()">
  <aside class="middle-full row">
    <!-- Header and Navigation -->
    <section class="middle-main clearFix" id="studentList">

      <!-- Data Table and Pagination -->
      <section class="search-data">

        <!-- Export and Toggler Here -->
        <div class="row">
          <div class="c-lg-6 c-md-6 c-sm-6 align-left">
          </div>
          <div class="c-lg-6 c-md-6 c-sm-6 align-left">
            <div class="field-wrapper">
              <img class="pull-right" src="../../../../assets/images/search.svg" style="max-width: 5%;" (click)="searchDatabase(search)"
              />
            </div>
            <div class="search-filter-wrapper" style="width:100%;">
              <input #search type="text" class="normal-field pull-right" placeholder="Search name" style="font-size:12px; margin: 0px 5px 2px -5px;"
                id="search" name="searchData" (keyup.enter)="searchDatabase(search)">
            </div>
          </div>
        </div>

        <!-- Enquiry DataTable -->
        <div class="row">
          <div class="c-lg-12 c-md-12 c-sm-12">
            <div class="table-scroll-wrapper">
              <div class="table table-responsive enquiry-table">
                <table class="align-center">
                  <thead>
                    <tr id="table-header" class="displayComp">
                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.list_name.title)">{{header.inventory_item.title}}</a>
                        </label>
                      </th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.referred_by.title)">{{header.category.title}}</a>
                        </label>
                      </th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.referred_by.title)">{{header.description.title}}</a>
                        </label>
                      </th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.source.title)">{{header.master_course.title}}</a>
                        </label>
                      </th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.created_date.title)">{{header.course.title}}</a>
                        </label>
                      </th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.status.title)">{{header.total_units.title}}</a>
                        </label>
                      </th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.total_count.title)">{{header.available.title}}</a>
                        </label>
                      </th>

                      <th></th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.total_count.title)">{{header.cost.title}}</a>
                        </label>
                      </th>

                      <th>
                        <label>
                          <a class="cursor-icon" style="color:white;" (click)="sortTableById(header.success_count.title)">{{header.edit.title}}</a>
                        </label>
                      </th>
                    </tr>
                  </thead>


                  <tbody class="" *ngIf="itemList.length != 0">

                    <tr id="row{{i}}" class="displayComp" *ngFor="let row of itemList; let i = index; trackBy: i;">

                      <td class="view-comp">
                        {{row.item_name}}
                      </td>
                      <td class="edit-comp ">
                        <div class="field-wrapper">
                          <input type="text" class="form-ctrl" [(ngModel)]="row.item_name" name="label">
                        </div>
                      </td>

                      <td class="view-comp">
                        {{row.category_name}}
                      </td>
                      <td class="edit-comp ">
                        <div class="field-wrapper">
                          <select id="" class="form-ctrl" name="row.category_id" [(ngModel)]="row.category_id">
                            <option *ngFor="let opt of categoryList" [value]="opt.category_id">
                              {{opt.category_name}}
                            </option>
                          </select>
                        </div>
                      </td>

                      <td class="view-comp ">
                        <div class="field-wrapper">
                          {{row.desc}}
                        </div>
                      </td>
                      <td class="edit-comp ">
                        <div class="field-wrapper">
                          <input type="text" class="form-ctrl" [(ngModel)]="row.desc" name="label">
                        </div>
                      </td>

                      <td class="view-comp">
                        {{row.standard_name}}
                      </td>
                      <td class="edit-comp">
                        <div class="field-wrapper">
                          <select id="" class="form-ctrl" name="row.standard_id" [(ngModel)]="row.standard_id">
                            <option *ngFor="let opt of masterCategoryList" [value]="opt.standard_id">
                              {{opt.standard_name}}
                            </option>
                          </select>
                        </div>
                      </td>

                      <td>
                        {{row.subject_name}}
                      </td>

                      <td>
                        {{row.alloted_units}}
                      </td>

                      <td>
                        {{row.available_units}}
                      </td>

                      <td class="view-comp">
                        <div class="displayAddItem" id="add-item{{i}}">
                          <a class="view-addItem" (click)="addItemsEnable(i)">Add Quantity</a>
                          <div class="field-wrapper edit-addItem">
                            <input type="number" class="form-ctrl" [(ngModel)]="row.units_added" name="label">
                          </div>
                        </div>
                      </td>

                      <td class="edit-comp" *ngIf="!isAddUnit">

                      </td>

                      <td class="edit-comp" *ngIf="isAddUnit">
                        <div class="field-wrapper">
                          <input type="number" class="form-ctrl" [(ngModel)]="row.unit_cost" name="label">
                        </div>
                      </td>


                      <td class="view-comp">
                        <div class="field-wrapper">
                          {{row.unit_cost}}
                        </div>
                      </td>
                      <td class="edit-comp ">
                        <div class="field-wrapper">
                          <input type="number" class="form-ctrl" [(ngModel)]="row.unit_cost" name="label">
                        </div>
                      </td>

                      <td class="table-action view-comp">
                        <ul>
                          <li>
                            <a (click)="editRow(i,row.item_id)">Edit</a>
                            <a *ngIf="row.is_delete" (click)="deleteRow(row, i)">Delete</a>
                          </li>
                        </ul>
                      </td>

                      <td class="table-action edit-comp">
                        <ul>
                          <li>
                            <a (click)="updateRow(row , i)">Update</a>
                          </li>
                          <li>
                            <a (click)="cancelRow(i)">Cancel
                            </a>
                          </li>
                        </ul>
                      </td>
                    </tr>
                  </tbody>

                  <tbody *ngIf="itemList.length == 0">
                    <tr class="empty-table-wrapper" style="background: none;">
                      <td colspan="12">
                        <ul>
                          <li style="font-weight: 700">{{fetchingDataMessage}}</li>
                        </ul>
                      </td>
                    </tr>
                  </tbody>

                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Paginator Here -->
        <div class="row filter-res pagination" style="width: 100%;">
          <div class="c-lg-12 c-md-12 c-sm-12 align-right">
            <pagination (goPage)="fetchTableDataByPage($event)" (goNext)="fetchNext()" (goPrev)="fetchPrevious()" [pagesToShow]="10"
              [page]="PageIndex" [perPage]="studentdisplaysize" [count]="totalRow">
            </pagination>
          </div>
        </div>

      </section>
    </section>
  </aside>
</section>


<!-- Delete PopUp -->
<!-- =============================================================================== -->
<section id="popup" class="popupWrapper fadeIn" *ngIf="deleteItemPopUp">
  <div class="popup pos-abs">
    <div class="popup-wrapper pos-rel">
      <span class="closePopup pos-abs fbold show" id="popupCloseBtn" (click)="closeDeletePopup()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="9310 2185 16 16">
          <g id="Group_1228" data-name="Group 1228" transform="translate(8298 1888)">
            <g id="Group_1213" data-name="Group 1213" transform="translate(34.189 -7.77)">
              <line id="Line_274" data-name="Line 274" class="cls-1" y2="19.798" transform="translate(992.81 305.77) rotate(45)" />
              <line id="Line_275" data-name="Line 275" class="cls-1" x1="19.798" transform="translate(978.81 305.77) rotate(45)" />
            </g>
            <rect id="Rectangle_686" data-name="Rectangle 686" style="stroke:none;" class="cls-2" width="16" height="16" transform="translate(1012 297)"
            />
          </g>
        </svg>
      </span>
      <div class="popup-content">
        <h2>Delete Inventory Item - Item Name: {{deleteRowDetails.item_name}}</h2>
        <div class="update-enquiry-form overflowHidden">
          <div class="enquiry-update-history">
            <h4>Are you Sure you wish to delete this data, it cannot be recovered later.</h4>
          </div>
          <div class="">
            <div class="clearfix">
              <aside class="pull-right popup-btn">
                <input type="button" value="Cancel" class="btn" (click)="closeDeletePopup()">
                <input type="button" value="Delete" class="redBtn btn" (click)="deleteStudent()">
              </aside>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>