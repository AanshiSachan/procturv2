<div id="editCityArea" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h3 class="modal-title">Edit Area</h3>
      </div>
      <div class="modal-body">
        <div class="edit-container">
          <div class="edit-item field-wrapper">
            <span class="edit-title">Country Name </span>
            <span>{{ (!editrecord?.country_name) ? '-' : editrecord.country_name}}</span>
          </div>
          <div class="edit-item field-wrapper">
            <span class="edit-title">State Name </span>
            <span>{{(!editrecord?.state_name) ? '-' : editrecord.state_name}}</span>
          </div>
          <div class="edit-item field-wrapper">
            <span class="edit-title">City Name </span>
            <span>{{ (!editrecord?.city) ? '-' : editrecord.city}}</span>
          </div>
          <div class="edit-item field-wrapper">
            <span class="edit-title">Area Name </span>
            <input type="text" name="" value="" [(ngModel)]="editAreaName" placeholder="Enter area name"
              class="edit-area-item form-ctrl">
          </div>
          <div class="edit-item field-checkbox-wrapper" style="width: 100px !important">
            <span class="edit-title" style="width: 100%;">Is Active</span>
            <input type="checkbox" id="active" value="" name="" class="form-checkbox" [(ngModel)]="editIsActiveStatus">
            <label for="active"></label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-default" (click)="updateArea()">Update</button>
      </div>
    </div>

  </div>
</div>

<div id="deleteModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <div class="alert-title-container">
          <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
          <h4 class="modal-title">Alert</h4>
        </div>
      </div>
      <div class="modal-body">
        <div class="msg-container">
          <span>Are you sure you want to delete it?</span>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">No, cancel!</button>
        <button *ngIf="activeSession == 'city_area'" type="button" class="btn btn-default delete-btn" (click)="deleteArea()">Yes, delete it!</button>
        <button *ngIf="activeSession == 'source'" type="button" class="btn btn-default delete-btn" (click)="deleteSource(deleteAreaId)">Yes, delete it!</button>
        <button *ngIf="activeSession == 'Referred_by'" type="button" class="btn btn-default delete-btn" (click)="deleteRefer(deleteAreaId)">Yes, delete it!</button>
      </div>
    </div>

  </div>
</div>
<main class="page-content" style="padding-left: 0 !important;">
  <div>
     <div class="w98 p-15">
    <nav aria-label="breadcrumb ">
        <ol style="padding-left: 0%;" class="breadcrumb arr-right">
          <li class="breadcrumb-item "><a routerLink="/view/leads" >Lead</a></li>
          <li class="breadcrumb-item "><a >Setup</a></li>
       </ol>
      </nav>
      <!-- Nav tabs -->
<ul class="nav main-shadow">
  <li class="nav-item">
    <a class="nav-link" [ngClass]="(activeSession == 'source') ? 'active' : ''" (click)="toggle('source');getSourceDetails()">Source</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" [ngClass]="(activeSession == 'closing_reason') ? 'active' : ''"(click)="toggle('closing_reason');getAllReasons()">Closing Reason</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" [ngClass]="(activeSession == 'city_area') ? 'active' : ''" (click)="toggle('city_area');getCountryList();searchArea();" >City/Area</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" [ngClass]="(activeSession == 'Referred_by') ? 'active' : ''" (click)="toggle('Referred_by');fetchReferInfo()">Referred By</a>
  </li>
</ul>
  </div>
</div>
<!-- Tab panes -->
<div class="tab-content" style="margin-top: 10px;">
  <div id="Source" *ngIf="activeSession == 'source'" [ngClass]="(activeSession == 'source') ? 'active' : ''" class="tab-pane">
    <div class="w96">
        <div style="margin-bottom: 10px;">
                  <input type="text" [(ngModel)]="createSource.name" class="reason-input" name="soure" placeholder="Add Source*">
                  <button (click)="addSourceData()" class="add_master_tag">Add</button>
        </div>
        <div>
          <div class="tableContainer" >
            <!-- <div> -->
              <div class="tableHeader">
                <div style="width: 80%;" class="tableData">
                  Source Name
                </div>
                <div style="width: 20%;" class="tableData">
                   <span class="right pr-40">
                    Action
                  </span>
                </div>
              </div>
            <!-- </div> -->
            <div class="section" *ngIf="sourceDetails?.length > 0">
              <div class="tableBody" style="box-shadow:-1px 1px 6px 0px rgb(0 0 0 / 10%)" *ngFor="let data of sourceDetails">
                <div style="width: 80%;" [ngStyle]="{'padding':data.isEdit ? '0' : '10px 15px'}" class="tableData">
                  <span *ngIf="!data.isEdit">{{data.name}}</span> 
                  <span *ngIf="data.isEdit">
                    <input style="margin: 0" type="text" [(ngModel)]="data.new_source_name" class="reason-input" name="soure">
                  </span> 
                </div>
                <div style="width: 20%;" *ngIf="!data.isEdit" class="tableData">
                  <span class="right pr-40">
                  <a (click)="EditSource(data, data.name)" style="vertical-align: middle;cursor: pointer;">
                    <img src="../../../../assets/images/EDit.png">
                  </a>
                  <a aria-hidden="true" data-toggle="modal" data-target="#deleteModal" (click)="setDeleteAreaId(data)" style="cursor: pointer;" class="pl-10">
                    <i style="color: red;font-size: 18px;font-weight: 400;" class="fa fa-trash"></i>
                  </a>
                </span>
              </div>
              <div style="width: 20%;" *ngIf="data.isEdit" class="tableData">
                <span class="updateAction" (click)="updateSource(data)">Update</span>
                <span class="updateAction" (click)="cancelEditSource(data)">Cancel</span>
              </div>
              </div>
            </div>
            <div class="section no-records" *ngIf="!sourceDetails?.length && !auth.isRippleLoad.getValue()">
              No Records found
            </div>
          </div>
        </div>
      </div>
  </div>
  <div id="closing_reason" *ngIf="activeSession == 'closing_reason'" [ngClass]="(activeSession == 'closing_reason') ? 'active' : ''" class="tab-pane">
    <div class="w96">
        <div style="margin-bottom: 10px;">
                  <input type="text" class="reason-input" name="" [(ngModel)]="createNewReasonObj.closing_desc" placeholder="Add closing reason*">
                  <button (click)="createNewReason()" class="add_master_tag">Add</button>
        </div>
        <div>
          <div class="tableContainer" >
            <!-- <div> -->
              <div class="tableHeader">
                <div style="width: 80%;" class="tableData">
                  Closing Reason
                </div>
                <div style="width: 20%;" class="tableData">
                   <span class="right pr-40">
                    Action
                  </span>
                </div>
              </div>
            <!-- </div> -->
            <div class="section" *ngIf="getAllClosingReasons?.length > 0">
              <div class="tableBody" style="box-shadow:-1px 1px 6px 0px rgb(0 0 0 / 10%)" *ngFor="let data of getAllClosingReasons">
                <div style="width: 80%;" [ngStyle]="{'padding':data.isEdit ? '0' : '10px 15px'}" class="tableData">
                  <span *ngIf="!data.isEdit">{{data.closing_desc}}</span> 
                  <span *ngIf="data.isEdit">
                    <input style="margin: 0" type="text" [(ngModel)]="data.new_source_name" class="reason-input" name="soure">
                  </span> 
                </div>
                <div style="width: 20%;" *ngIf="!data.isEdit" class="tableData">
                  <span class="right pr-40">
                  <a (click)="EditSource(data, data.closing_desc)" style="vertical-align: middle;cursor: pointer;">
                    <img src="../../../../assets/images/EDit.png">
                  </a>
                </span>
              </div>
              <div style="width: 20%;" *ngIf="data.isEdit" class="tableData">
                <span class="updateAction" (click)="saveInformation(data, 0)">Update</span>
                <span class="updateAction" (click)="cancelEditSource(data)">Cancel</span>
              </div>
              </div>
            </div>
            <div class="section no-records" *ngIf="!getAllClosingReasons?.length && !auth.isRippleLoad.getValue()">
              No Records found
            </div>
          </div>
        </div>
      </div>
  </div>
  <div id="city_area" *ngIf="activeSession == 'city_area'" [ngClass]="(activeSession == 'city_area') ? 'active' : ''" class="tab-pane">
    <div class="w96">
        <div style="margin-bottom: 10px;">
          <div class="row">
            <div class="col-lg-12 col-12" style="padding: 0;">
              <div class="row">
                <div class="col-lg-9 col-12" style="padding: 0;display: -webkit-box;-webkit-box-align: center;">
                  <!-- <form class="p-10"> -->
                    <div class="row">
                      <div class="filter-item field-wrapper" style="margin-left: 0px;">
                        <select class="form-ctrl" name="" [(ngModel)]="filter.country_ids" (ngModelChange)="getStateList()">
                          <option value="-1">Select Country</option>
                          <option title="{{country.country_name}}" [value]="country.id" *ngFor="let country of countryList">
                            {{ (country.country_name.length > 30) ? (country.country_name | slice:0:30) + '...' : country.country_name }}
                          </option>
                        </select>
                      </div>
                      <div class="filter-item field-wrapper">
                        <select class="form-ctrl" name="" [(ngModel)]="filter.state_ids" (ngModelChange)="getCityList()">
                          <option value="-1">Select State</option>
                          <option title="{{state.state_name}}" [value]="state.state_id" *ngFor="let state of stateList">
                            {{ (state.state_name.length > 30) ? (state.state_name | slice:0:30) + '...' : state.state_name }}</option>
                        </select>
                      </div>
                      <div class="filter-item field-wrapper">
                        <select class="form-ctrl" name="" [(ngModel)]="filter.city_ids">
                          <option value="-1">Select City</option>
                          <option title="{{city.city_name}}" [value]="city.city_id" *ngFor="let city of cityList">
                            {{ (city.city_name.length > 30) ? (city.city_name | slice:0:30) + '...' : city.city_name }}</option>
                        </select>
                      </div>
                      <div class="filter-item field-checkbox-wrapper" style="width: 100px !important; margin-top: 30px;">
                        <span class="edit-title" style="width: 100%;">Is Active</span>
                        <input type="checkbox" id="active" value="" name="" class="form-checkbox" [(ngModel)]="filter.is_active">
                        <label for="active"></label>
                      </div>
                      <div class="col-lg-1 col-12">
                          <button class="search" (click)="searchArea()">Search</button>
                      </div>
                    </div>
                  <!-- </form> -->
                </div>
                <div class="col-lg-3 col-12" style="padding: 0;">
                 <span class="right">
                  <input type="text" [(ngModel)]="areaSearchInput" name="areaSearchInput"
                  (keyup)="searchDatabase(search)" placeholder="Search" class="input magnifying-glass">
                  <button class="add_master_tag" (click)="toggleAddArea()">Add Area</button>
              </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div>
          <div class="tableContainer">
            <div class="tableHeader">
              <div class="tableData small">
                <span>State</span>
              </div>
              <div class="tableData small">
                <span>City</span>
              </div>
              <div class="tableData large">
                <span>Area</span>
              </div>
              <div class="tableData align-center medium">
                <span>Active Status</span>
              </div>
              <div class="tableData align-center medium">
                <span>Action</span>
              </div>
            </div>
            <div class="section" *ngIf="countryStateAreaList?.length > 0">
              <div class="tableBody" style="box-shadow:-1px 1px 6px 0px rgb(0 0 0 / 10%)" *ngFor="let record of countryStateAreaList">
                <div class="tableData small">
                  <span
                    title="{{record?.state_name}}">{{ (!record.state_name) ? '-' : (record.state_name.length > 20) ? (record.state_name | slice:0:20) + '...' : record.state_name}}</span>
                </div>
                <div class="tableData small">
                  <span
                    title="{{record?.city}}">{{ (!record.city) ? '-' : (record.city.length > 20) ? (record.city | slice:0:20) + '...' : record.city}}</span>
                </div>
                <div class="tableData large">
                  <span
                    title="{{record?.area}}">{{ (!record.area) ? '-' : (record.area.length > 50) ? (record.area | slice:0:50) + '...' : record.area }}</span>
                </div>
                <div class="tableData align-center medium">
                  <span *ngIf="record?.is_active == 'Y'" class="yes">Yes</span>
                  <span *ngIf="record?.is_active == 'N'" class="no">No</span>
                </div>
                <div class="tableData align-center medium">
                  <span class="right pr-40">
                    <a (click)="editArea(record)" data-toggle="modal" data-target="#editCityArea" style="vertical-align: middle;cursor: pointer;">
                      <img src="../../../../assets/images/EDit.png">
                    </a>
                    <a aria-hidden="true" data-toggle="modal" data-target="#deleteModal" (click)="setDeleteAreaId(record)" style="cursor: pointer;" class="pl-10">
                      <i style="color: red;font-size: 18px;font-weight: 400;" class="fa fa-trash"></i>
                    </a>
                  </span>
                </div>
              </div>
            </div>
            <div class="section no-records" *ngIf="!countryStateAreaList.length && !auth.isRippleLoad.getValue()">
              <span>No Records Found</span>
            </div>
          </div>
        </div>
        
    </div>
  </div>
  <div id="Referred_by" *ngIf="activeSession == 'Referred_by'" [ngClass]="(activeSession == 'Referred_by') ? 'active' : ''" class="tab-pane">
    <div class="w96">
        <div style="margin-bottom: 10px;">
                  <input type="text" [(ngModel)]="createReferer.name" class="reason-input" name="" placeholder="Add Referrer*">
                  <button (click)="addReferData()" class="add_master_tag">Add</button>
        </div>
        <div>
          <div class="tableContainer" >
            <!-- <div> -->
              <div class="tableHeader">
                <div style="width: 80%;" class="tableData">
                  Referrer Name
                </div>
                <div style="width: 20%;" class="tableData">
                   <span class="right pr-40">
                    Action
                  </span>
                </div>
              </div>
            <!-- </div> -->
            <div class="section" *ngIf="referList?.length > 0">
              <div class="tableBody" style="box-shadow:-1px 1px 6px 0px rgb(0 0 0 / 10%)" *ngFor="let data of referList">
                <div style="width: 80%;" [ngStyle]="{'padding':data.isEdit ? '0' : '10px 15px'}" class="tableData">
                  <span *ngIf="!data.isEdit">{{data.name}}</span> 
                  <span *ngIf="data.isEdit">
                    <input style="margin: 0" type="text" [(ngModel)]="data.new_source_name" class="reason-input" name="soure">
                  </span> 
                </div>
                <div style="width: 20%;" *ngIf="!data.isEdit" class="tableData">
                  <span class="right pr-40">
                  <a (click)="EditSource(data, data.name)" style="vertical-align: middle;cursor: pointer;">
                    <img src="../../../../assets/images/EDit.png">
                  </a>
                  <a aria-hidden="true" data-toggle="modal" data-target="#deleteModal" (click)="setDeleteAreaId(data)" style="cursor: pointer;" class="pl-10">
                    <i style="color: red;font-size: 18px;font-weight: 400;" class="fa fa-trash"></i>
                  </a>
                </span>
              </div>
              <div style="width: 20%;" *ngIf="data.isEdit" class="tableData">
                <span class="updateAction" (click)="updateRefer(data)">Update</span>
                <span class="updateAction" (click)="cancelEditSource(data)">Cancel</span>
              </div>
              </div>
            </div>
            <div class="section no-records" *ngIf="!referList.length && !auth.isRippleLoad.getValue()">
              <span>No Records Found</span>
            </div>
          </div>
        </div>
      </div>
  </div>
</div>

</main>

<app-add-city-area *ngIf=addArea (closePopup)="toggleAddArea($event)" [selectedData]="selectedData">
</app-add-city-area>