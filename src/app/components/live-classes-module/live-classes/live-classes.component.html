<loaders-css [loader]="'ball-scale-ripple-multiple'" class="app-loader-wrapper" [loaderClass]="'blueRipple'" *ngIf="JsonVars.isRippleLoad">
</loaders-css>

<div class="middle-section">
  <aside class="middle-full">
    <section class="middle-main clearFix activity-wrapper">
      <section class="middle-top clearFix bulk-header">
        <div>
          <h1 class="pull-left">
             <span>Live Class</span>
          </h1>
        </div>

      </section>
      <section>
        <div class="live-class-list">
          <div class="live-class-container" style="width:50%;">
            <div class="field-radio-wrapper">
              <input type="radio" [value]="false" class="form-radio" [(ngModel)]="liveClassFor" (ngModelChange)="getClassesFor()" name="liveClasses" id="liveClasses1">
              <label for="liveClasses1">Upcoming Classes</label>
            </div>
            <div class="field-radio-wrapper">
              <input type="radio" [value]="true"  class="form-radio" [(ngModel)]="liveClassFor" (ngModelChange)="getClassesFor()" name="liveClasses" id="liveClasses2">
              <label for="liveClasses2">Previous Classes</label>
            </div>
          </div>

          <div class="search-add-class-container">
            <div class="search-filter-wrapper"> 
              <i class="fa fa-search" aria-hidden="true"></i>
              <input type="text" class="normal-field" placeholder="Search" name="searchData" #searchVal (keyup)="searchInList(searchVal)">
            </div>
            <!-- <div class="filter-wrapper">
              <i class="fa fa-search" aria-hidden="true"></i>
              <select class="filter" name="" *ngIf="liveClassFor" [(ngModel)]="sortDate" (ngModelChange)="dateRangeChanges()">
                <option value="-1" selected="selected" hidden disabled>Filter By Date</option>
                <option value="last_week">Last 7 Days</option>
                <option value="this_month">This Month</option>
                <option value="last_month">Last Month</option>
                <option value="last_three_month">Last 3 months</option>
                <option value="custom_date_range">Custom Date range</option>
                <option value="all">All</option>
              </select>
            </div> -->
            <div class="add-class-container">
              <button type="button" name="button" class="add-class" routerLink='/view/live-classes/add'>
                <i class="fa fa-plus" aria-hidden="true" style="color: #0084f6;"></i>
                 Add Live Class</button>
            </div>
          </div>
        </div>
      </section>

      <section class="live-class">
        <div class="live-class-list-container" *ngIf="getClasses.length !=0">
          <div class="live-class-item" *ngFor="let class of getClasses">
            <div class="sub-item-1">
              <div class="session_name_and_id_container">
                <div class="session_name">
                  <span>{{class.session_name}}</span>
                </div>
                <div class="session_id">
                  <span>Session Id : {{class.session_id}}</span>
                </div>
              </div>
              <div class="notification_container" *ngIf="!liveClassFor">
                <span class="upcoming_class" *ngIf="timeLeft(today, class.start_datetime)">Ongoing</span>
                <!-- <div class="spinner">
                  <div class="bounce1"></div>
                  <div class="bounce2"></div>
                  <div class="bounce3"></div>
                </div> -->
                <button type="button" name="button" class="notification_btn" (click)="smsNotification(class.session_id)" *ngIf="!timeLeft(today, class.start_datetime)">
                  Send SMS Notification
                  <i class="fa fa-commenting" aria-hidden="true"></i>
                </button>
                <button type="button" name="button" class="notification_btn" (click)="pushNotification(class.session_id)" *ngIf="!timeLeft(today, class.start_datetime)">
                  Send Push Notification
                  <i class="fa fa-bell" aria-hidden="true"></i>
                </button>
              </div>
              <div class="action_container" *ngIf="!liveClassFor && !timeLeft(today, class.start_datetime)" >
                <button type="button" name="button" class="action_edit" (click)="editStudent(class.session_id)">
                  Edit
                  <i class="fa fa-pencil" aria-hidden="true"></i>
                </button>
                <button type="button" name="button" class="action_delete" (click)="cancel(class.session_id)">
                  Cancel
                  <i class="fa fa-times" aria-hidden="true"></i>
                </button>
              </div>
            </div>
            <div class="sub-item-2">
              <div class="item_type_1">
                <span style="color: #9898a3;">Faculty : </span>
                <span style="color: #585574;font-weight: 600;">{{class.teachersName}}</span>
              </div>
              <div class="item_type_1">
                <span  style="color: #585574;">
                  <span style="color: #9898a3;">Date : </span>
                  {{class.startDateTime | date: 'dd MMM yyyy'}}
                 </span>
                <span  style="color: #585574;">
                  <span style="color: #9898a3;">Duration : </span>
                  {{diffDate(class.startDateTime, class.endDateTime) }} hrs
                </span>
              </div>
              <div class="item_type_1">
                <span style="color: #585574;">
                  <span style="color: #9898a3;">Time : </span>
                  <span>{{class.startDateTime | date: 'shortTime'}} - {{class.endDateTime | date: 'shortTime'}}</span>
                </span>
                <span style="color: #585574;">
                  <span style="color: #9898a3;">Moderator : </span>
                  <span *ngIf="class.moderatorName != '' && class.moderatorName != null">{{class.moderatorName}}</span>
                  <span *ngIf="class.moderatorName == '' || class.moderatorName == null">-</span>
                </span>
              </div>
              <div class="item_type_3" *ngIf="!liveClassFor">
                <span style="color: #9898a3;">Time left : </span>
                <span  style="color: #585574;font-weight: 600;">{{getTimeLeft(today, class.startDateTime) }}</span>
              </div>
              <div class="item_type_3" *ngIf="liveClassFor">
                <span style="color: #9898a3;">Attendees : </span>
                <span  style="color: #585574;font-weight: 600;">{{class.attendeesCount}} of {{class.totalAttendeesLimit}}</span>
              </div>
              <div class="item_type_2">
                <button type="button" name="button" *ngIf="!liveClassFor && forUser && forTeacher(class.teachersUserIds)" [ngClass]="checkForTime(class.startDateTime) ? 'start_session' : 'notAllowed'" (click)="startLiveClass(class.session_link, class.startDateTime)">
                  <i class="fa fa-play" aria-hidden="true"></i>
                  &nbsp;
                  Start Class
                </button>
                <button type="button" name="button" class="repeat_session" *ngIf="liveClassFor" (click)="repeatSession(class.session_id)">
                  <i class="fa fa-repeat" aria-hidden="true"></i>
                  &nbsp;
                  Repeat Class
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- <section *ngIf="!liveClassFor">
        <div class="note-container">
          <span><span style="font-weight: 600;">NOTE : </span> Sessions can only be started before 30 minutes of start time.</span>
        </div>
      </section> -->

      <!-- Paginator Here -->
      <div class="row filter-res pagination pagination-correct" style="width: 100%;">
        <div class="c-lg-12 c-md-12 c-sm-12 align-right">
          <pagination (goPage)="fetchTableDataByPage($event)" (goNext)="fetchNext()" (goPrev)="fetchPrevious()" [pagesToShow]="10"
              [page]="PageIndex" [perPage]="displayClassSize" [count]="totalRow">
          </pagination>
        </div>
      </div>

      </section>
  </aside>
</div>


<section [hidden]="alertBox">
  <div class="confirmation_popup">
    <div class="confirm_title">
      <i class="fa fa-exclamation-triangle" aria-hidden="true" style="color: rgba(255,0,0,0.7);"></i> &nbsp;
      <span>Alert</span>
    </div>
    <div class="confirmation_msg_box">
      <span id="confirm_msg">Are you sure you want to cancel the session?</span>
    </div>
    <br>
    <!-- <div class="field-checkbox-wrapper">
      <input type="checkbox" id="sms" name="batch" [(ngModel)]="sendSMSNotification"
          class="form-checkbox">
      <label for="sms"> Send SMS Notification</label>
    </div>

    <div class="field-checkbox-wrapper">
      <input type="checkbox" id="push" name="batch" [(ngModel)]="sendPushNotification"
          class="form-checkbox">
      <label for="push"> Send Push Notification</label>
    </div> -->
    <div class="confirmation_button_container">
      <input type="button" value="Yes" class="btn" (click)="cancelSession()">
      <input type="button" value="No" class="btn" (click)="closeAlert()">
    </div>
  </div>
</section>

<div class="black-bg" id="black-bg" [hidden]="alertBox" (click)="closeAlert()">

</div>
