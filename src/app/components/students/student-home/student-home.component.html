<section class="middle-section clearFix" [ngBusy]="{busy: busy, message: 'Loading...', backdrop: false, delay: 100, maxDuration: 1000}"
    (click)="inputClicked($event)">
    <!-- =============================================================================== -->
    <!-- =============================================================================== -->
    <aside class="middle-full row">
        <!-- =============================================================================== -->
        <!--====================================middle Top section==========================-->
        <!-- =============================================================================== -->
        <section class="middle-top mb0 clearFix">
            <h1 class="pull-left">
                Student List
            </h1>
            <aside class="pull-right">
                <input type="button" value="Add Student" class="btn" routerLink="/student/add">
                <input type="button" value="Upload Student" class="btn" routerLink="/student/bulk">
            </aside>
        </section>
        <!-- =============================================================================== -->
        <!--====================================middle <Main> section==========================-->
        <!-- =============================================================================== -->
        <section class="middle-main clearFix" id="studentList">
            <!-- =============================================================================== -->
            <!-- Filter and seachbar section -->
            <section class="common-search-filter" id="searchFilter">
                <div class="filter-search">
                    <!-- Advanced Filter -->
                    <div class="filter-box clearFix">
                        <div class="c-lg-8 c-md-8 c-sm-8">
                            <div id="basic-search" class="search-filter-wrapper">
                                <input #search type="text" class="normal-field" placeholder="Search Student Name/Contact No." style="font-size:12px; margin: 0px 5px 0px -5px;"
                                    [(ngModel)]="searchBarData" name="searchData" (keyup.enter)="searchDatabase()">
                                <input type="button" class="normal-btn fullBlue btn" value="Search" (click)="searchDatabase()" />
                            </div>
                        </div>

                        <!-- Advanced Filter Trigger -->
                        <div class="c-lg-4 c-md-4 c-sm-4">
                            <div class="filter-right" style="float: right;">
                                <a href="javascript:void(0);" id="adFilterOpen" (click)="openAdFilter()" class="openAdFilter">Advanced Filter</a>
                                <a href="javascript:void(0);" id="adFilterExit" class="closeAdFilter hide" (click)="closeAdFilter()">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="3712 291 16 16">
                                        <g id="Group_1214" data-name="Group 1214" transform="translate(2700 -6)">
                                            <g id="Group_1213" data-name="Group 1213" transform="translate(34.189 -7.77)">
                                                <line id="Line_274" data-name="Line 274" class="cls-1" y2="19.798" transform="translate(992.81 305.77) rotate(45)" />
                                                <line id="Line_275" data-name="Line 275" class="cls-1" x1="19.798" transform="translate(978.81 305.77) rotate(45)" />
                                            </g>
                                            <rect id="Rectangle_686" data-name="Rectangle 686" class="cls-2" width="16" height="16" transform="translate(1012 297)" />
                                        </g>
                                    </svg>
                                    Close Advance Filter
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="filter-fields hide" style="visibility: visible; opacity: 1" id="advanced-filter-section">

                        <div class="filter-wrapper" *ngIf="isProfessional">

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="masterCourse" name="masterCourse" [(ngModel)]="advancedFilterForm.standard_id" (ngModelChange)="fetchCourseForMaster($event)"
                                        class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="std.standard_id" *ngFor="let std of standardList">
                                            {{std.standard_name}}
                                        </option>
                                    </select>
                                    <label for="masterCourse">Master Course</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="course" name="course" [(ngModel)]="advancedFilterForm.subject_id" class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="subject.subject_id" *ngFor="let subject of subjectList">
                                            {{subject.subject_name}}
                                        </option>
                                    </select>
                                    <label for="course">Course</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="batch" name="batch" [(ngModel)]="advancedFilterForm.batch_id" class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="b.batch_id" *ngFor="let b of batchList">
                                            {{b.batch_name}}
                                        </option>
                                    </select>
                                    <label for="batch">Batch</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="school" name="school" [(ngModel)]="advancedFilterForm.school_id" class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="sch.school_id" *ngFor="let sch of schoolList">
                                            {{sch.school_name}}
                                        </option>
                                    </select>
                                    <label for="school">Institutional/Custom2</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="status" [(ngModel)]="advancedFilterForm.language_inst_status" class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="stdst.data_key" *ngFor="let stdst of studentStatusList">
                                            {{stdst.data_value}}
                                        </option>
                                    </select>
                                    <label for="status">Status</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div id="slotwrapper" class="field-wrapper" (click)="multiselectVisible($event.target.id)">
                                    <input id="slot" type="text" [ngModel]="selectedSlotsString" name="slots" class="form-ctrl" disabled/>
                                    <label for="assignCourses">Slots</label>
                                </div>
                                <div id="slotmulti" class="hide multiselect-wrapper" (mouseleave)="multiselectVisible('slot')">
                                    <div class="multiselect-wrapper-inner">
                                        <ul class="">
                                            <li *ngFor="let slot of slots">
                                                <div class="field-checkbox-wrapper">
                                                    <input type="checkbox" value="" name="slot.label" [(ngModel)]="slot.status" (ngModelChange)="updateSlotSelected(slot)" class="form-checkbox">
                                                    <label for="slot.label">{{slot.label}}</label>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="radio-options">
                                    <div class="field-radio-wrapper">
                                        <input type="radio" value="1" [(ngModel)]="advancedFilterForm.is_active_status" name="sFilter" class="form-radio" id="active">
                                        <label for="active">Active</label>
                                    </div>
                                    <div class="field-radio-wrapper">
                                        <input type="radio" value="2" [(ngModel)]="advancedFilterForm.is_active_status" name="sFilter" class="form-radio" id="Inactive">
                                        <label for="Inactive">Inactive</label>
                                    </div>
                                    <div class="field-radio-wrapper">
                                        <input type="radio" value="3" [(ngModel)]="advancedFilterForm.is_active_status" name="sFilter" class="form-radio" id="both">
                                        <label for="both">both</label>
                                    </div>
                                </div>
                            </div>


                            <custom-student *ngFor="let component of customComponents">

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 1 && component.is_searchable == 'Y'" input-def>
                                    <div class="field-wrapper">
                                        <input type="text" value="" id="component.id" [(ngModel)]="component.value" class="form-ctrl" name="component.label" />
                                        <label for="component.label">{{component.label}} </label>
                                    </div>
                                </div>

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 2 && component.is_searchable == 'Y'" input-def>
                                    <br>
                                    <div class="field-checkbox-wrapper">
                                        <input class="form-checkbox" id="component.id" type="checkbox" [(ngModel)]="component.value" name="component.label" value="">
                                        <label for="component.label">{{component.label}} </label>
                                    </div>
                                </div>

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 3 && component.is_searchable == 'Y'" input-def>
                                    <div class="field-wrapper">
                                        <select id="component.id" class="form-ctrl" [(ngModel)]="component.value" name="component.label">
                                            <option value=""></option>
                                            <option *ngFor="let opt of component.prefilled_data" value="{{opt.data}}">{{opt.data}}</option>
                                        </select>
                                        <label for="component.label">{{component.label}} </label>
                                    </div>
                                </div>

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 4 && component.is_searchable == 'Y'" input-def>
                                    <div id="{{component.id}}wrapper" class="field-wrapper" (click)="multiselectVisible($event.target.id)">
                                        <input id="{{component.id}}" type="text" [ngModel]="component.selectedString" name="{{component.label}}" class="form-ctrl"
                                            disabled/>
                                        <label for="{{component.label}}">{{component.label}} </label>
                                    </div>

                                    <div id="{{component.id}}multi" class="hide multiselect-wrapper" (mouseleave)="multiselectVisible(component.id)">
                                        <div class="multiselect-wrapper-inner">
                                            <ul class="">
                                                <li *ngFor="let opt of component.prefilled_data">
                                                    <div class="field-checkbox-wrapper">
                                                        <input type="checkbox" value="" name="{{opt.data}}" [(ngModel)]="opt.checked" (ngModelChange)="updateMultiSelect(opt, component.id)"
                                                            class="form-checkbox">
                                                        <label for="opt.data">{{opt.data}}</label>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                            </custom-student>


                            <div class="row">
                                <div class="c-lg-12 c-md-12 c-sm-12">
                                    <div class="field-wrapper pull-left">
                                        <input type="button" class="btn filterSearchBtn redBtn" value="Search Now" (click)='advancedSearch()'>
                                    </div>
                                    <div class="field-wrapper pull-left">
                                        <input type="button" class="btn filterSearchBtn" value="Clear Advanced Filter" (click)='clearAdvancedFilterForm()'>
                                    </div>
                                </div>
                            </div>


                        </div>

                        <div class="filter-wrapper" *ngIf="!isProfessional">

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="standard" name="standard" [(ngModel)]="advancedFilterForm.standard_id" (ngModelChange)="fetchCourseForMaster($event)"
                                        class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="std.standard_id" *ngFor="let std of standardList">
                                            {{std.standard_name}}
                                        </option>
                                    </select>
                                    <label for="standard">Standard</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="masterCourse" name="masterCourse" [(ngModel)]="advancedFilterForm.master_course_name" (ngModelChange)="updateSubCourse($event)"
                                        class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="mc.master_course" *ngFor="let mc of masterCourseList">
                                            {{mc.master_course}}
                                        </option>
                                    </select>
                                    <label for="masterCourse">Master Course</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="course" name="course" [(ngModel)]="advancedFilterForm.course_id" class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="course.course_id" *ngFor="let course of subCourseList">
                                            {{course.course_name}}
                                        </option>
                                    </select>
                                    <label for="course">Course</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="school" name="school" [(ngModel)]="advancedFilterForm.school_id" class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="sch.school_id" *ngFor="let sch of schoolList">
                                            {{sch.school_name}}
                                        </option>
                                    </select>
                                    <label for="school">Institutional/Custom2</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="field-wrapper">
                                    <select id="status" [(ngModel)]="advancedFilterForm.language_inst_status" class="form-ctrl">
                                        <option value=""></option>
                                        <option [value]="stdst.data_key" *ngFor="let stdst of studentStatusList">
                                            {{stdst.data_value}}
                                        </option>
                                    </select>
                                    <label for="status">Status</label>
                                </div>
                            </div>

                            <div class="c-lg-4 c-md-4 c-sm-4">
                                <div class="radio-options">
                                    <div class="field-radio-wrapper">
                                        <input type="radio" value="1" [(ngModel)]="advancedFilterForm.is_active_status" name="sFilter" class="form-radio" id="active">
                                        <label for="active">Active</label>
                                    </div>
                                    <div class="field-radio-wrapper">
                                        <input type="radio" value="2" [(ngModel)]="advancedFilterForm.is_active_status" name="sFilter" class="form-radio" id="Inactive">
                                        <label for="Inactive">Inactive</label>
                                    </div>
                                    <div class="field-radio-wrapper">
                                        <input type="radio" value="3" [(ngModel)]="advancedFilterForm.is_active_status" name="sFilter" class="form-radio" id="both">
                                        <label for="both">both</label>
                                    </div>
                                </div>
                            </div>

                            <custom-student *ngFor="let component of customComponents">

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 1 && component.is_searchable == 'Y'" input-def>
                                    <div class="field-wrapper">
                                        <input type="text" value="" id="component.id" [(ngModel)]="component.value" class="form-ctrl" name="component.label" />
                                        <label for="component.label">{{component.label}} </label>
                                    </div>
                                </div>

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 2 && component.is_searchable == 'Y'" input-def>
                                    <br>
                                    <div class="field-checkbox-wrapper">
                                        <input class="form-checkbox" id="component.id" type="checkbox" [(ngModel)]="component.value" name="component.label" value="">
                                        <label for="component.label">{{component.label}} </label>
                                    </div>
                                </div>

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 3 && component.is_searchable == 'Y'" input-def>
                                    <div class="field-wrapper">
                                        <select id="component.id" class="form-ctrl" [(ngModel)]="component.value" name="component.label">
                                            <option value=""></option>
                                            <option *ngFor="let opt of component.prefilled_data" value="{{opt.data}}">{{opt.data}}</option>
                                        </select>
                                        <label for="component.label">{{component.label}} </label>
                                    </div>
                                </div>

                                <div class="c-lg-4 c-md-4 c-sm-4" *ngIf="component.type == 4 && component.is_searchable == 'Y'" input-def>
                                    <div id="{{component.id}}wrapper" class="field-wrapper" (click)="multiselectVisible($event.target.id)">
                                        <input id="{{component.id}}" type="text" [ngModel]="component.selectedString" name="{{component.label}}" class="form-ctrl"
                                        />
                                        <label for="{{component.label}}">{{component.label}} </label>
                                    </div>
                                    <div id="{{component.id}}multi" class="hide multiselect-wrapper" (mouseleave)="multiselectVisible(component.id)">
                                        <div class="multiselect-wrapper-inner">
                                            <ul class="">
                                                <li *ngFor="let opt of component.prefilled_data">
                                                    <div class="field-checkbox-wrapper">
                                                        <input type="checkbox" value="" name="{{opt.data}}" [(ngModel)]="opt.checked" (ngModelChange)="updateMultiSelect(opt, component.id)"
                                                            class="form-checkbox">
                                                        <label for="opt.data">{{opt.data}}</label>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                            </custom-student>

                            <div class="row">
                                <div class="c-lg-12 c-md-12 c-sm-12">
                                    <div class="field-wrapper pull-left">
                                        <input type="button" class="btn filterSearchBtn redBtn" value="Search Now" (click)='advancedSearch()'>
                                    </div>
                                    <div class="field-wrapper pull-left">
                                        <input type="button" class="btn filterSearchBtn" value="Clear Advanced Filter" (click)='clearAdvancedFilterForm()'>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>

                </div>
            </section>
            <!-- =============================================================================== -->
            <!-- =============================================================================== -->
            <!-- =============================================================================== -->
            <!-- Data table here -->
            <section class="search-data">

                <div class="row class filter-res">
                    <div class="c-lg-6 c-md-6 c-sm-6 align-left">
                        <ul class="export-print">
                            <li>
                                <label>
                                    Showing {{ getMin() }} to {{ getMax() }} of {{ totalRow }} Students
                                </label>
                            </li>
                            <li>
                                <div class="bulk-dropdown">
                                    <label class="bulk-dropbtn">
                                        Student per page :
                                        <button class="bulk-dropbtn-border" id="bulk-action" #bulkaction (click)="bulkActionFunction()" type="button" data-toggle="dropdown">
                                            {{studentdisplaysize}}
                                            <span class="caret"></span>
                                        </button>
                                    </label>
                                    <div id="bulk-drop" class="bulk-dropdown-content">
                                        <a *ngFor="let size of sizeArr" (click)="updateTableBatchSize(size)">
                                            {{size}}
                                        </a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="c-lg-6 c-md-6 c-sm-6 align-right">
                        <ul class="export-print">
                            <li>
                                <!-- <p-splitButton label="bulk action 1" icon="fa-envelope-o" (onClick)="bulkActionPerformer(1)" [model]="bulkActionItems"></p-splitButton> -->
                            </li>
                            <li class="export-icon" (click)="downloadAllStudent()">
                                <a id="student_download"></a>
                                Export
                            </li>
                            <!-- <li>
                                <ss-multiselect-dropdown [options]="myOptions" [texts]="myTexts" [settings]="mySettings" [(ngModel)]="optionsModel" (ngModelChange)="toggleOptionChange($event)">
                                </ss-multiselect-dropdown>
                            </li> -->
                        </ul>
                    </div>
                </div>


                <!-- Student  Table  Here-->
                <div class="row" id="student-table">

                    <div class="table-scroll-wrapper">
                        <div class="table table-responsive student-table">
                            <proctur-checkbox-table [records]="studentDataSource" [tableName]="'student'" [settings]="StudentSettings" [dataStatus]="loading_message"
                                [key1]="'isActive'" [primaryKey]="'student_id'" (userRowSelect)="userRowSelect($event)" (rowsSelected)="getRowCount($event)"
                                (rowIdArr)="getSelected($event)" (sortById)="sortTableById($event)">
                            </proctur-checkbox-table>
                        </div>
                    </div>



                    <div id="student-side" class="sidenav">
                        <a href="javascript:void(0)" class="closebtn" (click)="closeSideBar($event)">
                            X
                        </a>
                        <div *ngIf="!isSideBar" class="skeleton">
                            <div class="skel1"></div>
                            <div class="skel2"></div>
                        </div>


                        <student-sidebar *ngIf="isSideBar" [rowData]="selectedRow" [customComponent]="studentCustomComponent" [studentDetails]="studentDetailsById"
                            (closeSide)="closeSideBar($event)" (editStudent)="editStudent($event)" (deleteStudent)="deleteStudentOpen($event)" 
                            (editNotes)="openEditComment($event)" >
                        </student-sidebar>
                    </div>

                </div>


                <!-- Paginator Here -->
                <div class="row filter-res pagination" style="width: 100%;">
                    <div class="c-lg-12 c-md-12 c-sm-12 align-right">
                        <pagination (goPage)="fectchTableDataByPage($event)" (goNext)="fetchNext()" (goPrev)="fetchPrevious()" [pagesToShow]="10"
                            [page]="PageIndex" [perPage]="studentdisplaysize" [count]="totalRow">
                        </pagination>
                    </div>
                </div>


            </section>
            <!-- =============================================================================== -->
            <!-- =============================================================================== -->
            <!-- =============================================================================== -->
        </section>
        <!-- =============================================================================== -->
        <!-- =============================================================================== -->
        <!-- =============================================================================== -->
    </aside>
    <!-- =============================================================================== -->
    <!-- =============================================================================== -->
    <!-- =============================================================================== -->
    <!-- Delete PopUp -->
    <!-- =============================================================================== -->
    <section id="popup" class="popupWrapper fadeIn" *ngIf="isDeleteStudentPrompt">
        <div class="popup pos-abs">
            <div class="popup-wrapper pos-rel">
                <span class="closePopup pos-abs fbold show" id="popupCloseBtn" (click)="closeDeletePopup()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="9310 2185 16 16">
                        <g id="Group_1228" data-name="Group 1228" transform="translate(8298 1888)">
                            <g id="Group_1213" data-name="Group 1213" transform="translate(34.189 -7.77)">
                                <line id="Line_274" data-name="Line 274" class="cls-1" y2="19.798" transform="translate(992.81 305.77) rotate(45)" />
                                <line id="Line_275" data-name="Line 275" class="cls-1" x1="19.798" transform="translate(978.81 305.77) rotate(45)" />
                            </g>
                            <rect id="Rectangle_686" data-name="Rectangle 686" style="stroke:none;" class="cls-2" width="16" height="16" transform="translate(1012 297)"
                            />
                        </g>
                    </svg>
                </span>
                <div class="popup-content">
                    <h2>Delete Student - Student Name: {{selectedRow.student_name}}</h2>
                    <div class="update-enquiry-form overflowHidden">
                        <div class="enquiry-update-history">
                            <h4>Are you Sure you wish to delete this data, it cannot be recovered later.</h4>
                        </div>
                        <div class="">
                            <div class="clearfix">
                                <aside class="pull-right popup-btn">
                                    <input type="button" value="Cancel" class="btn" (click)="closeDeletePopup()">
                                    <input type="button" value="Delete" class="redBtn btn" (click)="deleteStudent()">
                                </aside>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <!-- =============================================================================== -->
    <!-- Add Comment Popup -->
    <!-- =============================================================================== -->
    <section id="popup" class="popupWrapper fadeIn" *ngIf="isAddComment">
        <div class="popup pos-abs">
            <div class="popup-wrapper pos-rel">
                <span class="closePopup pos-abs fbold show" id="popupCloseBtn" (click)="closeEditComment()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="9310 2185 16 16">
                        <g id="Group_1228" data-name="Group 1228" transform="translate(8298 1888)">
                            <g id="Group_1213" data-name="Group 1213" transform="translate(34.189 -7.77)">
                                <line id="Line_274" data-name="Line 274" class="cls-1" y2="19.798" transform="translate(992.81 305.77) rotate(45)" />
                                <line id="Line_275" data-name="Line 275" class="cls-1" x1="19.798" transform="translate(978.81 305.77) rotate(45)" />
                            </g>
                            <rect id="Rectangle_686" data-name="Rectangle 686" style="stroke:none;" class="cls-2" width="16" height="16" transform="translate(1012 297)"
                            />
                        </g>
                    </svg>
                </span>
                <div class="popup-content">
                    <h2>Add Comment - Student Name: {{selectedRow.student_name}}</h2>
                    <div class="update-enquiry-form overflowHidden">
                        <div class="enquiry-update-history" style="max-height: max-content;">
                            <div class="field-wrapper">
                                <textarea placeholder="Update Comment Here (max 1000 characters)" rows="1" cols="10" style="height: 60px;" id="addcommentEdit"
                                    class="form-ctrl" [(ngModel)]="selectedRow.comments">
                                </textarea>
                            </div>
                        </div>
                        <div class="">
                            <div class="clearfix">
                                <aside class="pull-right popup-btn">
                                    <input type="button" value="Cancel" class="btn" (click)="closeEditComment()">
                                    <input type="button" value="Add" class="redBtn btn" (click)="updateComment()">
                                </aside>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>


</section>