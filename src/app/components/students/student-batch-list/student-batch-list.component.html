<loaders-css [loader]="'ball-scale-ripple-multiple'" class="app-loader-wrapper" [loaderClass]="'blueRipple'" *ngIf="isRippleLoad">
</loaders-css>
<proctur-popup [sizeWidth]="'large'">

    <span class="closePopup pos-abs fbold show" id="popupCloseBtn" (click)="closeBatchAssign()" close-button>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="9310 2185 16 16">
            <g id="Group_1228" data-name="Group 1228" transform="translate(8298 1888)">
                <g id="Group_1213" data-name="Group 1213" transform="translate(34.189 -7.77)">
                    <line id="Line_274" data-name="Line 274" class="cls-1" y2="19.798" transform="translate(992.81 305.77) rotate(45)" />
                    <line id="Line_275" data-name="Line 275" class="cls-1" x1="19.798" transform="translate(978.81 305.77) rotate(45)" />
                </g>
                <rect id="Rectangle_686" data-name="Rectangle 686" style="stroke:none;" class="cls-2" width="16" height="16" transform="translate(1012 297)"
                />
            </g>
        </svg>
    </span>

    <h2 popup-header style="margin-bottom: 10px;" *ngIf="!isProfessional">Course and Fee Assignment</h2>
    <h2 popup-header style="margin-bottom: 10px;" *ngIf="isProfessional">Batch and Fee Assignment</h2>

    <div class="batch-wrapper" popup-content>
        <div class="filter-row row">
            <div class="c-lg-5 radio-filter">
                <!-- <p style="padding: 20px 10px 0px;">* Fee will be mapped automatically if fee schedules are defined at course level.</p> -->
                <div class="c-lg-2">
                    <a (click)="getOnlyAssigned()" title="click to view assigned" style="cursor: pointer;">
                        <h3>
                            {{assignedCount}}/{{dataList.length}}
                        </h3>
                    </a>
                </div>
                <div class="c-lg-10">
                    <div class="radio-options">
                        <div class="field-radio-wrapper">
                            <input [(ngModel)]="batchFilter.state" (ngModelChange)="newMultiFilterFetchBatch()" type="radio" value="0" name="bFilter"
                                class="form-radio" id="both" checked>
                            <label for="both">Both</label>
                        </div>
                        <div class="field-radio-wrapper">
                            <input [(ngModel)]="batchFilter.state" (ngModelChange)="newMultiFilterFetchBatch()" type="radio" value="1" name="bFilter"
                                class="form-radio" id="assigned">
                            <label for="assigned">Assigned</label>
                        </div>
                        <div class="field-radio-wrapper">
                            <input [(ngModel)]="batchFilter.state" (ngModelChange)="newMultiFilterFetchBatch()" type="radio" value="2" name="bFilter"
                                class="form-radio" id="unassigned">
                            <label for="unassigned">Unassigned</label>
                        </div>
                    </div>
                </div>

            </div>
            <div class="c-lg-7">
                <div class="c-lg-6">
                    <div *ngIf="!isProfessional" class="field-wrapper header-select">
                        <select name="" id="" [(ngModel)]="batchFilter.currentStd" (ngModelChange)="fetchDataCustom($event)" class="form-ctrl">
                            <option value="-1">Select Standard</option>
                            <option [value]="standard.standard_id" *ngFor="let standard of standardList">
                                {{standard.standard_name}}
                            </option>
                        </select>
                    </div>
                </div>
                <div class="c-lg-6">
                    <div class="field-wrapper">
                        <input type="text" name="" class="form-ctrl" [(ngModel)]="model" (ngModelChange)="changed($event)" placeholder="Search" id="">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <table>
                <thead>
                    <tr>
                        <th></th>
                        <th class="mcourse" *ngIf="!isProfessional">Master Course</th>
                        <th class="courseN" *ngIf="!isProfessional">Course</th>
                        <th class="mcourse" *ngIf="isProfessional">Batch Name</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th *ngIf="!isProfessional">Course Assign Date</th>
                        <th *ngIf="isProfessional">Batch Assign Date</th>
                        <th>Academic Year</th>
                        <th>Fee Template</th>
                    </tr>
                </thead>
            </table>
        </div>
        <div class="batch-table row">
            <table>
                <tbody *ngIf="batchList.length != 0">
                    <tr *ngFor="let batch of batchList; let i = index">
                        <td>
                            <div class="inst-no">
                                <div class="field-checkbox-wrapper">
                                    <input type="checkbox" id="batchcheck{{i}}" name="batch" [(ngModel)]="batch.isSelected" (ngModelChange)="batchChangeAlert($event, batch)"
                                        class="form-checkbox">
                                    <label></label>
                                </div>
                            </div>
                        </td>

                        <td class="mcourse" [title]="batch.data.master_course" *ngIf="!isProfessional">{{batch.data.master_course}}</td>

                        <td class="courseN"  [title]="batch.data.course_name" *ngIf="!isProfessional">{{batch.data.course_name}}</td>

                        <td *ngIf="!isProfessional">{{batch.data.start_date}}</td>

                        <td *ngIf="!isProfessional">{{batch.data.end_date}}</td>

                        <td *ngIf="isProfessional">{{batch.data.batch_name}}</td>

                        <td *ngIf="isProfessional">{{batch.data.start_date}}</td>

                        <td *ngIf="isProfessional">{{batch.data.end_date}}</td>

                        <td>
                            <div class="field-wrapper datePickerBox has-value">
                                <input type="text" value="" id="assigndate" name="assigndate" [(ngModel)]="batch.assignDate" readonly="true" class="form-ctrl bsDatepicker"
                                    bsDatepicker>
                            </div>
                        </td>

                        <td>
                            <div class="field-wrapper">
                                <select name="acadyr" id="acadyr" [(ngModel)]="batch.data.academic_year_id" [disabled]="true" [ngStyle]="{'background':'lightgrey'}" class="form-ctrl">
                                    <option [value]="year.inst_acad_year_id" [selected]="batch.data.academic_year_id == year.inst_acad_year_id" *ngFor="let year of academicYear">{{year.inst_acad_year}}</option>
                                </select>
                            </div>
                        </td>

                        <td>
                            <div class="field-wrapper">
                                <select name="feetm" id="feetm" [(ngModel)]="batch.data.selected_fee_template_id" class="form-ctrl" (ngModelChange)="onFeeTemplateChanges(batch.data)">
                                    <option [value]="fee.template_id" [selected]="batch.data.selected_fee_template_id == fee.template_id" *ngFor="let fee of batch.data.feeTemplateList">{{fee.template_name}}</option>
                                </select>
                            </div>
                        </td>
                    </tr>
                </tbody>
                <tbody *ngIf="batchList.length == 0">
                    <tr>
                        <td colspan="7">
                            No Data Found
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="" popup-footer>
        <div class="clearfix">
            <aside class="pull-right popup-btn">
                <input type="button" value="Cancel" class="btn" (click)="closeBatchAssign()">
                <input type="button" value="Save" class="fullBlue btn" (click)="assignBatch()">
            </aside>
        </div>
    </div>

</proctur-popup>

<section [hidden]="alertBox">
  <div class="confirmation_popup">
    <div class="confirm_title">
      <i class="fa fa-exclamation-triangle" aria-hidden="true" style="color: rgba(255,0,0,0.7);"></i> &nbsp;
      <span>Alert</span>
    </div>
    <div class="confirmation_msg_box">
      <span id="confirm_msg">Do you wish to unassign student from the batch?</span>
    </div>
    <br>
    <div class="field-checkbox-wrapper">
      <input type="checkbox" id="delete_unpaid_fee" name="batch" [(ngModel)]="delete_unpaid_fee"
          class="form-checkbox">
      <label> Delete unpaid fees installments</label>
    </div>
    <div class="confirmation_button_container">
      <input type="button" value="Yes" class="btn" (click)="unassign_course()">
      <input type="button" value="No" class="btn" (click)="closeAlert()">
      <!-- <input type="button" value="Cancel" class="btn" (click)="closeAlert()"> -->
    </div>
  </div>
</section>

<div class="black-bg" id="black-bg" [hidden]="alertBox" (click)="closeAlert()">

</div>
