<loaders-css [loader]="'ball-scale-ripple-multiple'" class="app-loader-wrapper" [loaderClass]="'blueRipple'" *ngIf="isRippleLoad">
</loaders-css>
<section class="middle-section clearFix">
  <section class="course-second course">
    <div class="boxPadding15">

      <!-- Expanding Table -->
      <section class="middle-top mb0 clearFix">
        <h1 class="pull-left" style="padding-left:20px; padding-top:10px;">
          Course List
        </h1>
        <aside class="headEnq pull-right" style="margin-top:5px;">
          <div style="display: inline-flex;
          position: absolute;
          top: -12px;">
            <!-- <p-splitButton label="{{selectedRowCount}} Enquiry Selected" [model]="bulkAddItems" *ngIf="selectedRowCount != 0"></p-splitButton> -->
          </div>
          <ul style="display: inline-flex;">
            <li class="headerBtn" routerLink='add'>
              <i>
                <svg viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0" preserveAspectRatio="xMinYMin meet" class="artdeco-icon"
                  focusable="false">
                  <path d="M14,9H9v5H7V9H2V7H7V2H9V7h5V9Z" class="small-icon" style="fill: currentColor"></path>
                </svg>
              </i>
              <p>
                Add Course
              </p>
            </li>

          </ul>
        </aside>
      </section>



      <section class="clearFix tableCourseExp calender-view1">
        <div class="tableCourseInn table-responsive ">
          <table>
            <thead>
              <tr>
                <th style="width:30%; text-align: left">
                  <label style="cursor:pointer;" (click)="sortTable('master_course')">Master Course Name</label>
                </th>
                <th style="width:25%">
                  <label style="cursor:pointer;" (click)="sortTable('coursee_names')">Course(s)</label>
                </th>
                <th style="width:25%">
                  <label style="cursor:pointer;" (click)="sortTable('standard_name')">Standard</label>
                </th>
                <th style="width:20%">Action</th>

              </tr>
            </thead>
            <tbody id="tbodyItem{{i}}" class="table-accor-head" *ngFor="let row of courseList; let i=index;">
              <tr>
                <td colspan="4">
                  <div class="accordian-heading">
                    <h4 class="clearFix ">
                      <span class="close-accor" (click)="toggleTbodyClass(i)">-</span>
                      <span class="open-accor" (click)="toggleTbodyClass(i)">+</span>
                      <span class="date-c" (click)="toggleTbodyClass(i)">{{row.master_course}}</span>
                      <span class="pull-right" routerLink="{{row.master_course}}" style="cursor: pointer;padding-right: 9% !important;text-align: left;">
                        <i class="edit-icon" aria-hidden="true" style="margin-right: 5px;" title="Edit"></i>Edit
                      </span>
                    </h4>
                  </div>
                </td>
              </tr>
              <tr id="tbodyView{{i}}" class="hide">
                <td colspan="4">
                  <table>
                    <tbody class="table-accor-view accorInnerTable">
                      <tr *ngFor="let sc of row.coursesList; let y= index;">
                        <td style="width:30%"></td>
                        <td style="width:25%">{{sc.course_name}}</td>
                        <td style="width:25%">{{row.standard_name}}</td>
                        <td style="width:20%">
                          <div class="action-box ">
                            <a style="cursor:pointer" (click)="addStudentToBatch(sc)">Add Student
                              <!-- <i class="far fa fa-plus-square" style="font-size: 25px" alt="Add Student" title="Add Student"></i> -->
                            </a>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
            </tbody>
            <tbody *ngIf="courseList.length == 0 && dataStatus === 1">
              <tr *ngFor="let dummy of dummyArr">
                <td *ngFor="let c of columnMaps">
                  <div class="skeleton">
                  </div>
                </td>
              </tr>
            </tbody>
            <tbody *ngIf="(courseList.length ==0 && dataStatus === 2)">
              <tr>
                <td colspan="5" style="text-align:center">
                  No Course Found
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Pagination -->

      <div class="row filter-res pagination" style="width: 100%;">
        <div class="c-lg-12 c-md-12 c-sm-12 align-right">
          <pagination (goPage)="fetchTableDataByPage($event)" (goNext)="fetchNext()" (goPrev)="fetchPrevious()" [pagesToShow]="10"
            [page]="PageIndex" [perPage]="displayBatchSize" [count]="totalRow">
          </pagination>
        </div>
      </div>

    </div>
  </section>
</section>



<!-- =============================================================================== -->
<!-- =============================================================================== -->
<section id="popup" class="popupWrapper fadeIn" *ngIf="addStudentPopUp">
  <div class="popup pos-abs popup-body-container">
    <div class="popup-wrapper pos-rel">
      <span class="closePopup pos-abs fbold show" id="popupCloseBtn" (click)="closeStudentPopup()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="9310 2185 16 16">
          <g id="Group_1228" data-name="Group 1228" transform="translate(8298 1888)">
            <g id="Group_1213" data-name="Group 1213" transform="translate(34.189 -7.77)">
              <line id="Line_274" data-name="Line 274" class="cls-1" y2="19.798" transform="translate(992.81 305.77) rotate(45)" />
              <line id="Line_275" data-name="Line 275" class="cls-1" x1="19.798" transform="translate(978.81 305.77) rotate(45)" />
            </g>
            <rect id="Rectangle_686" data-name="Rectangle 686" style="stroke:none;" class="cls-2" width="16" height="16" transform="translate(1012 297)"
            />
          </g>
        </svg>
      </span>
      <div class="popup-content student-assign-popup">
        <div class="row popup-title">
          <h2>Course Name :
            <span>{{courseDetails.course_name}}</span>
          </h2>
        </div>

        <div class="row filter-section">
          <div class="c-sm-4 c-md-4 c-lg-4 radio-button">
            <div class="field-radio-wrapper">
              <input type="radio" name="bothRadio" id="bothRadio" class="form-radio" value="0" [(ngModel)]="searchFilter.unassignFlag"
                (ngModelChange)="onRadioButtonChange()">
              <label for="bothRadio">Both</label>
            </div>
            <div class="field-radio-wrapper">
              <input type="radio" name="assignRadio" id="assignRadio" value="1" class="form-radio" [(ngModel)]="searchFilter.unassignFlag"
                (ngModelChange)="onRadioButtonChange()">
              <label for="assignRadio">Assigned</label>
            </div>
            <div class="field-radio-wrapper">
              <input type="radio" name="unassignStudent" id="unassignStudent" value="2" class="form-radio" [(ngModel)]="searchFilter.unassignFlag"
                (ngModelChange)="onRadioButtonChange()">
              <label for="unassignStudent">UnAssigned</label>
            </div>
          </div>
          <div class="c-sm-6 c-md-6 c-lg-6">

            <div class="c-sm-6 c-md-6 c-lg-6">
              <div class="field-wrapper">
                <select class="form-ctrl" [(ngModel)]="searchFilter.standard_id" name="standard" id="standard">
                  <option value="-1">Select Standard</option>
                  <option *ngFor="let opt of standardList" [value]="opt.standard_id">
                    {{opt.standard_name}}
                  </option>
                </select>

              </div>
            </div>

            <div class="c-sm-2 c-md-2 c-lg-2">
              <button class="btn" (click)="getAllStudentList()">Go</button>
            </div>

            <div class="c-sm-4 c-md-4 c-lg-4">
              <div class="search-filter-wrapper">
                <input #searchVal type="text" class="normal-field" placeholder="Search" id="searchStudent" name="searchData" [(ngModel)]="searchData">
              </div>
            </div>

          </div>
        </div>

        <div *ngIf="showTable">
          <div class="table-wrapper">
            <table>
              <thead>
                <th style="padding: 6px 0px 6px 20px;">
                  <div class="field-checkbox-wrapper">

                    <input #idSelectAll type="checkbox" class="form-checkbox" [(ngModel)]="allChecked" (click)="selectAllCheckBox(idSelectAll)">
                    <label></label>
                  </div>
                </th>
                <th>
                  Student ID
                </th>
                <th>
                  Student Name
                </th>
                <th>
                  Contact No.
                </th>
                <th>
                  Standard Class
                </th>
                <th>
                  Academic Year
                </th>
                <th>
                  Fee Template
                </th>
              </thead>
              <tbody>
                <tr id="row{{i}}" *ngFor="let row of (studentList | searchPipe:searchData); let i = index; trackBy: i;">
                  <td>
                    <div class="field-checkbox-wrapper">

                      <input type="checkbox" class="form-checkbox" [(ngModel)]="row.assigned">
                      <label></label>
                    </div>
                  </td>
                  <td>
                    {{row.student_disp_id}}
                  </td>
                  <td>
                    {{row.student_name}}
                  </td>
                  <td>
                    {{row.student_phone}}
                  </td>
                  <td>
                    {{row.student_class}}
                  </td>
                  <td>
                    <div class="field-wrapper">
                      <select class="form-ctrl" [(ngModel)]="row.academic_year" style="background: transparent">
                        <option value="-1">Select</option>
                        <option *ngFor="let opt of academicList" [value]="opt.inst_acad_year_id">
                          {{opt.inst_acad_year}}
                        </option>
                      </select>
                    </div>
                  </td>
                  <td>
                    <div class="field-wrapper">
                      <select class="form-ctrl" [(ngModel)]="row.assigned_fee_template_id" style="background: transparent">
                        <option value="-1">Select</option>
                        <option *ngFor="let opt of feeTemplateDataSource" [value]="opt.template_id">
                          {{opt.template_name}}
                        </option>
                      </select>
                    </div>
                  </td>
                </tr>
                <tr *ngIf="(studentList.length == 0)">
                  <td colspan="9">
                    No Student Details Found
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="row btn-section" style="margin: 10px 10px 0 0;">
            <button class="btn fullBlue pull-right" (click)="saveChanges()">Save</button>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>