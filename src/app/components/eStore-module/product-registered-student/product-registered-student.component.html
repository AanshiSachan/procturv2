<div class="middle-section clear-fix">

  <section class="middle-top clearFix bulk-header">
    <div>
      <h1 class="pull-left">
        <a routerLink="/view/e-store/home" style="padding:0px; ">
          eStore
        </a>
        <i style="font-family: 'FontAwesome';" class="fas fa-angle-right"></i>
        <span>Registered User</span>
      </h1>
    </div>
  </section>

  <div class="filter-section">
    <div class="row" style="display: -webkit-box;-webkit-box-align: center;">
      <!-- <div class="searchbox1" style="width: 20%;padding-right: 0;">
        <div style="margin-top: 20px;padding-left: 1%">
          <div class="search-filter-wrapper">
            <input type="text" class="normal-field form-class" placeholder="Search" name="searchData" [(ngModel)]="searchText"
              (keyup)="searchInList()"
              style="width: 100%;">
          </div>
        </div>
      </div> -->
      <div class="searchbox2">
        <div style="padding-right: 1%">
          <div class="search-filter-wrapper" style="font-size: 12px;padding-left: 10px;padding-right: 10px;">
            <label for="slug"style="width: 100%">Ecourse</label>
            <select [(ngModel)]="filter.course_type_id" [disabled]="filter.product_id!=''" class="form-ctrl form-class">
              <option value="0" selected>Select Ecourse</option>
              <option *ngFor="let item of EcourseData" [value]="item.course_type_id" title="{{item.course_type}}">
                  {{ (item.course_type.length > 30) ? (item.course_type | slice:0:30) + '...' : item.course_type }}
              </option>
            </select>
          </div>
        </div>
      </div>
      <span style="margin-left: 15px;">OR</span>
      <div class="searchbox2">
        <div style="padding-left: 1%">
          <div class="search-filter-wrapper" style="font-size: 12px;padding-left: 10px;padding-right: 10px;">
            <label for="product_id" style="width: 100%">Product</label>
            <select [(ngModel)]="filter.product_id" [disabled]="filter.course_type_id!=0" class="form-ctrl form-class">
              <option value="" selected>Select Product</option>
              <option *ngFor="let product of productList" [value]="product.id" title="{{product.title}}">
                {{ (product.title.length > 30) ? (product.title | slice:0:30) + '...' : product.title }}
              </option>
            </select>
          </div>
        </div>
      </div> 
      <div class="searchbox2" style="padding-left: 0;padding-right: 0;">
        <div class="c-lg-1 btn-wrap" style="margin-top: 4%">
          <button class="btn fullBlue" (click)="filterData('1')">Search</button>
        </div>
      </div>
      <!-- <div class="searchbox2" style="text-align: right;width: 50%;" *ngIf="!AdvanceFilter">
        <span (click)="AdvanceFilter = true" class="advance-filter-text" style="color: #0084f6;">Advance Filter </span>
      </div> -->
    </div>
  </div>

  <!-- <div class="filter-section AdvanceFilterSection" *ngIf="AdvanceFilter">
    <div class="row">
      <div class="searchbox2" style="text-align: right;width: 98%;">
        <span (click)="AdvanceFilter = false" class="advance-filter-text" style="color: red">X Close Advance Filter </span>
      </div>
    </div>
    <div class="row" style="display: -webkit-box;-webkit-box-align: center;">

      <div class="searchbox2">
        <div style="padding-right: 1%" class="form-group field-wrapper form-el-width datePickerBox">
          <div class="search-filter-wrapper" style="font-size: 12px;padding-left: 10px;padding-right: 10px;">
            <label class="text-bold">Sales From Date</label>
            <input type="text" value="" id="FromDate" class="form-ctrl form-class bsDatepicker dateFormat"
              [(ngModel)]="searchText" name="FD" bsDatepicker readonly="true" />
          </div>
        </div>
      </div>

      <div class="searchbox2">
        <div style="padding-right: 1%" class="form-group field-wrapper form-el-width datePickerBox">
          <div class="search-filter-wrapper" style="font-size: 12px;padding-left: 10px;padding-right: 10px;">
            <label class="text-bold">Sales To Date</label>
            <input type="text" value="" id="ToDate" class="form-ctrl form-class bsDatepicker dateFormat"
              [(ngModel)]="searchText" name="FD" bsDatepicker readonly="true" />
          </div>
        </div>
      </div>

      <div class="searchbox2">
        <div style="padding-right: 1%">
          <div class="search-filter-wrapper" style="font-size: 12px;padding-left: 10px;padding-right: 10px;">
            <label for="slug"style="width: 100%">Status</label>
            <select [(ngModel)]="filter.slug" class="form-ctrl form-class">
              <option value="" selected>Select</option>
              <option value="open">Open</option>
              <option value="student admitted">Student Admitted</option>
              <option value="student enquired">Student Enquired</option>
            </select>
          </div>
        </div>
      </div>

      <div class="searchbox2">
        <div style="padding-left: 1%">
          <div class="search-filter-wrapper" style="font-size: 12px;padding-left: 10px;padding-right: 10px;">
            <label for="product_id" style="width: 100%">Product</label>
            <select [(ngModel)]="filter.product_id" class="form-ctrl form-class">
              <option value="" selected>Select Product</option>
              <option *ngFor="let product of productList" [value]="product.id" title="{{product.title}}">
                {{ (product.title.length > 30) ? (product.title | slice:0:30) + '...' : product.title }}
              </option>
            </select>
          </div>
        </div>
      </div>
      <div class="searchbox2">
        <div style="padding-right: 1%">
          <div class="search-filter-wrapper" style="font-size: 12px;padding-left: 10px;padding-right: 10px;">
            <label for="slug"style="width: 100%">Item Type</label>
            <select [(ngModel)]="filter.slug" class="form-ctrl form-class">
              <option value="" selected>Select Item</option>
              <option *ngFor="let item of ItemTypeData" [value]="item.slug" title="{{item.name}}">
                  {{ (item.name.length > 30) ? (item.name | slice:0:30) + '...' : item.name }}
              </option>
            </select>
          </div>
        </div>
      </div>
      <div class="searchbox2" style="width: 5%;">
        <div class="c-lg-1 btn-wrap">
          <button class="btn fullBlue" (click)="filterData()">Go</button>
        </div>
      </div>
    </div>
  </div> -->


  <!-- <br> -->
  <!-- <data-display-table #child [displayKeys]="tableSetting" [displayData]="usersList" (editView)='optionSelected($event)'>
  </data-display-table> -->
  <div>
    <section class="login-tube pull-right" style="position: absolute;right: 22px;
    margin-top: 6px;">
        <nav>
            <ul class="login-nav">
                <li class="pos-rel">
                    <i class="icons">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                            <path id="gearIcon" d="M24 14.187v-4.374c-2.148-.766-2.726-.802-3.027-1.529-.303-.729.083-1.169 1.059-3.223l-3.093-3.093c-2.026.963-2.488 1.364-3.224 1.059-.727-.302-.768-.889-1.527-3.027h-4.375c-.764 2.144-.8 2.725-1.529 3.027-.752.313-1.203-.1-3.223-1.059l-3.093 3.093c.977 2.055 1.362 2.493 1.059 3.224-.302.727-.881.764-3.027 1.528v4.375c2.139.76 2.725.8 3.027 1.528.304.734-.081 1.167-1.059 3.223l3.093 3.093c1.999-.95 2.47-1.373 3.223-1.059.728.302.764.88 1.529 3.027h4.374c.758-2.131.799-2.723 1.537-3.031.745-.308 1.186.099 3.215 1.062l3.093-3.093c-.975-2.05-1.362-2.492-1.059-3.223.3-.726.88-.763 3.027-1.528zm-4.875.764c-.577 1.394-.068 2.458.488 3.578l-1.084 1.084c-1.093-.543-2.161-1.076-3.573-.49-1.396.581-1.79 1.693-2.188 2.877h-1.534c-.398-1.185-.791-2.297-2.183-2.875-1.419-.588-2.507-.045-3.579.488l-1.083-1.084c.557-1.118 1.066-2.18.487-3.58-.579-1.391-1.691-1.784-2.876-2.182v-1.533c1.185-.398 2.297-.791 2.875-2.184.578-1.394.068-2.459-.488-3.579l1.084-1.084c1.082.538 2.162 1.077 3.58.488 1.392-.577 1.785-1.69 2.183-2.875h1.534c.398 1.185.792 2.297 2.184 2.875 1.419.588 2.506.045 3.579-.488l1.084 1.084c-.556 1.121-1.065 2.187-.488 3.58.577 1.391 1.689 1.784 2.875 2.183v1.534c-1.188.398-2.302.791-2.877 2.183zm-7.125-5.951c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3zm0-2c-2.762 0-5 2.238-5 5s2.238 5 5 5 5-2.238 5-5-2.238-5-5-5z"
                            />
                        </svg>
                    </i>
                    <div class="dropdown">
                        <ul class="user-detail">
                            <li (click)="exportToExcel()" class="asHover" >
                                <i class="fa fa-file-excel-o" style="font-family: 'FontAwesome'; display: inline-block;"></i>
                                <strong style="display: inline-block;">Export as Excel</strong>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </nav>
    </section>
</div>
  <div class="btn-container" style="float: right;">
    <div class="btn-item">
      <button type="button" *ngIf="selectedRowCount != 0" class="btn pull-right" name="button" (click)="isOptions = !isOptions">
          {{selectedRowCount}} Students Selected &nbsp;
          <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
      </button>
      <div class="more-info-container" *ngIf="isOptions" (mouseleave)="isOptions = false" #optMenu>

          <div class="more-info-item hand_icon">
              <span style="cursor: pointer;" (click)="getAllMessageFromServer()"><i class="fa fa-bell"></i> Send Notification</span>
          </div>
      </div>
  </div>
</div>
  <section style="margin-top: 10px;">
    <div class="table-container" style="margin-bottom: 10px;">
      <div class="heading-container">
        <div class="heading-item" style="width: 5%;">
          <span>
            <div class="field-checkbox-wrapper">
              <input type="checkbox" class="form-checkbox" [checked]="isAllChecked()"
                [(ngModel)]="selectAll" (change)="toggleAllCheckBox()" id="ch2">
              <label for="ch2"></label>
            </div>
          </span>
        </div>
        <div class="heading-item" style="text-align: left;">
          <span>Name</span>
        </div>
        <div class="heading-item" style="width: 20%;">
          <span>Contact No.</span>
        </div>
        <div class="heading-item" style="width: 25%;">
          <span>Email Id</span>
        </div>
        <div class="heading-item" style="width: 20%;">
          <span>Registered Date</span>
        </div>
        <div class="heading-item" style="width: 10%;">
          <span>Status</span>
        </div>
        <div class="heading-item" style="width: 10%;">
          <span>Action</span>
        </div>
      </div>
      <div class="value-outer-container" *ngIf="usersList?.length!=0">
        <div class="value-container" *ngFor="let data of usersList;let i= index">
          <div class="value-item" style="width: 5%;">
            <div class="field-checkbox-wrapper">
              <input type="checkbox" class="form-checkbox"
                [checked]="data.isSelected" [(ngModel)]="data.isSelected" [id]="'checkbox-'+i" (ngModelChange)="rowCheckboxChange(data)">
              <label [for]="'checkbox-'+i"></label>
            </div>
          </div>
          <div class="value-item" style="text-align: left;">
            <span
              title="{{data.name}}">{{(data.name.length > 80) ? (data.name | slice:0:80) + '...' : data.name}}</span>
          </div>
          <div class="value-item" style="width: 20%">
            {{(data.phone != '') ? (data.phone) : '-'}}
          </div>
          <div class="value-item" style="width: 25%;">
            {{(data.email_id != '') ? (data.email_id) : '-'}}
          </div>
          <div class="value-item" style="width: 20%;">
            {{(data.registered_date != '') ? (data.registered_date) : '-'}}
          </div>
          <div class="value-item" style="width: 10%;">
            {{(data.open_user_status != '-') ? (data.open_user_status) : '-'}}
          </div>
          <div class="value-item" style="width: 10%;">
              <drop-menu [dropType]="dropType" *ngIf="data.open_user_status == '-'" [info]="data" [menuOptions]="menuOptions"
                (selectedRecord)="optionSelected($event)"></drop-menu>
                <span *ngIf="data.open_user_status != '-'">
                  <button aria-expanded="true" style="cursor: no-drop;" class="d-item dropdown-trigger">
                    <span class="d-item svg-icon-wrap">
                        <span class="visually-hidden"></span>
                        <div aria-hidden="true" type="ellipsis-horizontal-icon">
                            <svg class="artdeco-icon" focusable="false" height="24px" preserveAspectRatio="xMinYMin meet" viewBox="0 0 24 24" width="24px" x="0" y="0">
                                <path class="large-icon" d="M2,10H6v4H2V10Zm8,4h4V10H10v4Zm8-4v4h4V10H18Z" style="fill: currentColor"></path>
                            </svg>
                        </div>
                    </span>
                </button>
                </span>
          </div>
        </div>
      </div>
      <div class="value-outer-container" style="text-align: center;padding-top: 5%;font-weight: 600;"
        *ngIf="usersList?.length==0">
        <div *ngIf="!isRippleLoad"> No data found </div>
      </div>
    </div>
  </section>
  <div class="row filter-res pagination" #pager id="pager" style="width: 100%;margin: 0;">
    <div class="c-lg-12 c-md-12 c-sm-12 align-right">
      <pagination (goPage)="filterData($event)" (goNext)="fetchNext()" (goPrev)="fetchPrevious()" [pagesToShow]="10"
        [page]="varJson.PageIndex" [perPage]="varJson.displayBatchSize" [sizeArr]="varJson.sizeArr" (sizeChange)="updateTableBatchSize($event)"
        [count]="varJson.total_items">
      </pagination>
    </div>
  </div>

</div>

<div *ngIf="notificationPopup" class="notification_popup">
  <div class="row c-md-12" style="padding:0;">
    <span style="width: 100%;text-align: right;">
       <span style="cursor: pointer;font-size: 16px;font-weight: 600;" (click)="notificationPopup = false"> X </span>
    </span>
  </div>
  <div class="row c-md-12" style="padding: 0;margin-bottom: 5px;">
    <div class="c-md-4">
      <div class="c-md-12" style="padding: 0">
        <span style="font-weight: 600;"> Send Notification:</span>
      </div>
      <div class="c-md-12" style="padding:0">
        <div class="c-md-12" style="padding: 0;margin-top: 10px;margin-bottom: 5px;font-weight: 600;">
          <span>SMS Type </span>
        </div>
        <div class="c-md-6" style="padding:0">
          <input style="-webkit-appearance:radio" type="radio" id="transactional" name="transactional"
          class="form-checkbox" value="1" [checked]="transational_type" [(ngModel)]="transational_type">
          <label for="transactional">Tranasactional</label>
        </div>
        <div class="c-md-6" style="padding:0">
          <input style="-webkit-appearance:radio" type="radio" id="promotional" name="promotional"
          class="form-checkbox" value="2" [checked]="transational_type" [(ngModel)]="transational_type">
          <label for="promotional">Promotional</label>
        </div>
      </div>      
     </div>
    <div class="c-md-5" [ngStyle]="{'background':addSMS?'#efefef':'none'}">
      <div *ngIf="addSMS">
      <textarea placeholder="Write your message here..." [(ngModel)]="message" name="message">
      </textarea>
      <div style="font-size: 12px;display: -webkit-box;-webkit-box-align: center;margin-top: 5px;margin-bottom: 10px;"
        class="row c-md-12">
        <div class="c-md-4" style="padding:0;">Character Count</div>
        <div class="c-md-4" style="padding-right: 0;">
          <div class="msgCount">{{message?.length}}</div>
        </div>
        <div class="c-md-6" style="text-align: right;padding-right: 25px;">Message Count: 1</div>
      </div>
    </div>
    </div>
    <div class="c-md-3" style="text-align: right;margin-top: 10px;padding: 0;">
      <div class="c-md-12">
        <span (click)="addSMS=!addSMS" style="border: 1px solid #0084f6;cursor: pointer;color: #0084f6;border-radius: 4px;padding: 5px;">
          <i *ngIf="!addSMS" class="fa fa-plus"></i>
          <i *ngIf="addSMS" class="fa fa-minus"></i>
            Add SMS</span>
      </div>
      <div class="c-md-12" style="margin-top: 45px;">
        <div *ngIf="addSMS">
          <button class="btn fullBlue" style="background: no-repeat;color: #0084f6;" (click)="addSMS = false">Cancel</button>
          <button class="btn fullBlue" (click)="saveMSG()">Save SMS</button>
        </div>
      </div>
    </div>
  </div>
  <!-- <div class="row c-md-12" style="margin-top: 10px;">
    <div class="c-md-12">
      SMS Type
    </div>
    <div class="c-md-12">
      <span>Tranasactional </span>
      <span>Promotional</span>
    </div>
  </div> -->
  <div class="table-container">
    <div class="heading-container" style="background: #fafafa;font-size: 12px;font-weight: 600;">
      <div class="heading-item" style="width: 5%">
      </div>
      <div class="heading-item" style="text-align: left;">
        <span>SMS</span>
      </div>
      <div class="heading-item" style="text-align: left;width: 15%;">
        <span>SMS Status</span>
      </div>
      <div class="heading-item" style="width: 15%;text-align: left;">
        Date
      </div>
      <div class="heading-item" style="width: 15%;text-align: left;">
        Action
      </div>
    </div>
    <div class="value-outer-container" *ngIf="messageList?.length>0" style="min-height: 40vh;max-height: 40vh;">
      <div class="value-container" *ngFor="let data of messageList; let i = index;" style="padding:10px">
        <div class="heading-item" style="width: 5%">
          <!-- <input type="radio" class="form-ctrl" name="selected" [(ngModel)]="data.selected" [id]="'selected-'+i" [value]="data.selected" [checked]="data.selected"> -->
          <!-- <div class="field-radio-wrapper"> -->
          <input style="-webkit-appearance:radio" type="radio" name="bothRadio" [id]="'bothRadio-'+i"
            class="form-radio" [value]="i" [checked]="data.selected" [(ngModel)]="data.selected"
            (ngModelChange)="changeSelectedMsg(data)" [disabled]="data.statusValue == 'Open'">
          <!-- </div> -->
        </div>
        <div class="value-item" style="text-align: left;">
          {{data.message}}
        </div>
        <div class="value-item" style="text-align: left;width: 15%;">
          {{data.statusValue}}
        </div>
        <div class="value-item" style="text-align: left;width: 15%;">
          {{data.date}}
        </div>
        <div class="value-item" style="width: 15%;text-align: left;">
          <span *ngIf="data.statusValue == 'Open'" title="Approve" (click)="ApproveMsg(data.message_id)"
            style="padding:10px;cursor: pointer;"><i class="fa fa-check-circle"
              style="font-size: 14px;color: #01DF01;"></i> </span>
          <span title="Edit" (click)="editSMS(data)" style="padding:10px;cursor: pointer;"><i
              class="fa fa-pencil edit-icon-pencil" style="font-size: 14px;color: #0084f6;"></i></span>
          <span *ngIf="data.statusValue == 'Open'"  title="Delete" (click)="DeleteMsg(data.message_id)"
            style="padding:10px;cursor: pointer;"><i class="fa fa-times-circle"
              style="color: red;font-size: 14px;"></i></span>
        </div>
      </div>
    </div>
    <div class="value-outer-container" *ngIf="messageList?.length == 0"
      style="text-align: center;padding: 10%;font-weight: 600;">
      <span>No data found</span>
    </div>
  </div>
  <div class="c-md-12" style="margin-top: 20px;text-align: right;">
      <button class="btn fullBlue" (click)="sendNotification()">Send</button>
      <button class="btn fullBlue" (click)="sendPushNotification()">Send Push Notification</button>
  </div>
</div>
<div *ngIf="notificationPopup" class="black-bg" (click)="notificationPopup = false"></div>